<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.29.0">
    <meta name="project" content="Astarte v1.2.0-dev">

    <title>Using Trigger Delivery Policies — Astarte v1.2.0-dev</title>
    <link rel="stylesheet" href="dist/html-elixir-2YOS5DIE.css" />

    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-X7YVL3G2.js"></script>
    <script src="dist/sidebar_items-58764854.js"></script>

      <script src="../common_vars.js"></script>

    <script async src="dist/html-XN2TSG4M.js"></script>


  </head>
  <body data-type="extras" class="page-extra">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle" aria-label="toggle sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <i class="ri-search-2-line" aria-hidden="true" title="Submit search"></i>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <i class="ri-close-line ri-lg" aria-hidden="true" title="Cancel search"></i>
    </button>
    <label class="search-label">
      <p class="sr-only">Search</p>
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">

      <a href="https://docs.astarte-platform.org/astarte/1.0/">
        <img src="assets/logo.png" alt="Astarte" class="sidebar-projectImage">
      </a>

    <div class="sidebar-projectDetails">
      <a href="https://docs.astarte-platform.org/astarte/1.0/" class="sidebar-projectName" translate="no">
Astarte
      </a>
      <strong class="sidebar-projectVersion" translate="no">
        v1.2.0-dev
      </strong>
    </div>
    <ul class="sidebar-listNav">
      <li><a id="extras-list-link" href="#full-list">Pages</a></li>


    </ul>
  </div>

  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>
<button class="settings display-settings">
  <i class="ri-settings-3-line"></i>
  <span class="sr-only">Settings</span>
</button>


    <a href="https://github.com/astarte-platform/astarte/blob/release-1.0/doc/pages/user/062-using_trigger_delivery_policies.md#L1" title="View Source" class="view-source" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>

  <span>Using Trigger Delivery Policies</span>
</h1>

<p><em>Note: Trigger Delivery Policies are an experimental feature, see <a href="#known-issues">Known Issues</a> for more information about their current status.</em></p><p>Trigger Delivery Policies allow customizing what Astarte is supposed to do in case of delivery errors on HTTP events
and how to handle events that have not been delivered. More details on Trigger Delivery Policies can be found in the <a href="062-trigger_delivery_policies.html">Architecture Documentation</a>.</p><p>Astarte allows you to install and delete Trigger Delivery Policies dynamically through its clients.
A Trigger Delivery Policy is linked to an <a href="060-using_triggers.html">HTTP Trigger</a> by specifying its name in the Trigger definition.
A Trigger can be linked to at most one Trigger Delivery Policy, but a single Trigger Delivery Policy may serve any number of Triggers.</p><h2 id="listing-trigger-delivery-policies" class="section-heading">
  <a href="#listing-trigger-delivery-policies" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">listing-trigger-delivery-policies</p>
  </a>
  Listing Trigger Delivery Policies
</h2>
<p>At any time, you can list existing Trigger Delivery Policies in a Realm and fetch their details and definitions.</p><h3 id="listing-and-querying-trigger-delivery-policies-using-realm-management-api" class="section-heading">
  <a href="#listing-and-querying-trigger-delivery-policies-using-realm-management-api" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">listing-and-querying-trigger-delivery-policies-using-realm-management-api</p>
  </a>
  Listing and querying Trigger Delivery Policies using Realm Management API
</h3>
<p>To list all existing Trigger Delivery Policies in a Realm:</p><p><code class="inline">GET api.&lt;your astarte domain&gt;/realmmanagement/v1/&lt;realm name&gt;/policies</code></p><pre><code class="json">{
  &quot;data&quot;: [
    &quot;my_trigger_delivery_policy&quot;,
    &quot;simple_trigger_delivery_policy&quot;,
    &quot;other_trigger_delivery_policy&quot;,
    &quot;retry_upon_all_errors_delivery_policy&quot;
  ]
}</code></pre><p>To get a Trigger Delivery Policy definition:</p><p><code class="inline">GET api.&lt;your astarte domain&gt;/realmmanagement/v1/&lt;realm name&gt;/policies/simple_trigger_delivery_policy</code></p><pre><code class="json">{
  &quot;data&quot;: {
    &quot;name&quot; : &quot;simple_trigger_delivery_policy&quot;,
    &quot;maximum_capacity&quot; : 100,
    &quot;error_handlers&quot; : [
        {
            &quot;on&quot; : &quot;any_error&quot;,
            &quot;strategy&quot; : &quot;discard&quot;
        }
    ]
  }
}</code></pre><h2 id="installing-a-trigger-delivery-policy" class="section-heading">
  <a href="#installing-a-trigger-delivery-policy" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">installing-a-trigger-delivery-policy</p>
  </a>
  Installing a Trigger Delivery Policy
</h2>
<p>To install a Trigger Delivery Policy, you need its JSON definition. Then you can install the Trigger Delivery Policy via Realm Management APIs.</p><p>The name of the Trigger Delivery Policy must be unique within the Realm, or an error will be returned.</p><h3 id="installing-a-trigger-delivery-policy-using-realm-management-apis" class="section-heading">
  <a href="#installing-a-trigger-delivery-policy-using-realm-management-apis" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">installing-a-trigger-delivery-policy-using-realm-management-apis</p>
  </a>
  Installing a Trigger Delivery Policy using Realm Management APIs
</h3>
<p><code class="inline">POST api.&lt;your astarte domain&gt;/realmmanagement/v1/&lt;realm name&gt;/policies</code></p><p>The POST request must have the following request body, with content type <code class="inline">application/json</code></p><pre><code class="json">{
  &quot;data&quot;: {
    &quot;name&quot; : &quot;simple_trigger_delivery_policy&quot;,
    &quot;maximum_capacity&quot; : 100,
    &quot;error_handlers&quot; : [
        {
            &quot;on&quot; : &quot;any_error&quot;,
            &quot;strategy&quot; : &quot;discard&quot;
        }
    ]
  }
}</code></pre><h2 id="deleting-a-trigger-delivery-policy" class="section-heading">
  <a href="#deleting-a-trigger-delivery-policy" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">deleting-a-trigger-delivery-policy</p>
  </a>
  Deleting a Trigger Delivery Policy
</h2>
<p>To delete a Trigger Delivery Policy, you need to know its name.
A Trigger Delivery Policy can be deleted only if no Triggers linked to it are present in the Realm.</p><h3 id="deleting-a-trigger-delivery-policy-using-realm-management-apis" class="section-heading">
  <a href="#deleting-a-trigger-delivery-policy-using-realm-management-apis" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">deleting-a-trigger-delivery-policy-using-realm-management-apis</p>
  </a>
  Deleting a Trigger Delivery Policy using Realm Management APIs
</h3>
<p><code class="inline">DELETE api.&lt;your astarte domain&gt;/realmmanagement/v1/&lt;realm name&gt;/policies/simple_trigger_delivery_policy</code></p><h2 id="trigger-delivery-policy-examples" class="section-heading">
  <a href="#trigger-delivery-policy-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">trigger-delivery-policy-examples</p>
  </a>
  Trigger Delivery Policy examples
</h2>
<p>This section outlines two examples of Trigger Delivery Policy.</p><h3 id="a-simple-trigger-delivery-policy" class="section-heading">
  <a href="#a-simple-trigger-delivery-policy" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">a-simple-trigger-delivery-policy</p>
  </a>
  A Simple Trigger Delivery Policy
</h3>
<p>The following Trigger Delivery Policy discards events on any error.
This is the only behaviour previous Astarte versions (i.e. &lt; 1.1) allowed.</p><pre><code class="json">{
    &quot;name&quot; : &quot;simple_policy&quot;,
    &quot;maximum_capacity&quot; : 100,
    &quot;error_handlers&quot; : [
        {
            &quot;on&quot; : &quot;any_error&quot;,
            &quot;strategy&quot; : &quot;discard&quot;
        }
    ]
}</code></pre><h3 id="a-more-complex-trigger-delivery-policy" class="section-heading">
  <a href="#a-more-complex-trigger-delivery-policy" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">a-more-complex-trigger-delivery-policy</p>
  </a>
  A More Complex Trigger Delivery Policy
</h3>
<p>The following policy has a different behaviour depending on whether the HTTP delivery error is a client or a server one. </p><pre><code class="json">{
    &quot;name&quot; : &quot;complex_policy&quot;,
    &quot;maximum_capacity&quot; : 100,
    &quot;error_handlers&quot; : [
            {
                &quot;on&quot; : &quot;server_error&quot;,
                &quot;strategy&quot; : &quot;retry&quot;
            },
            {
                &quot;on&quot; : &quot;client_error&quot;,
                &quot;strategy&quot; : &quot;discard&quot;
            }
        ],
    &quot;retry_times&quot; : 5,
    &quot;event_ttl&quot; : 10
}</code></pre><p>If an HTTP client error occurs, then Astarte will try to resend the event up to 5 times.
If there occurs an HTTP server error, then Astarte will do nothing. 
At most 100 events can be in the queue at any time; if more than 100 events are present in the queue, the oldest ones will be deleted (even if they were resent less than 5 times in the case of HTTP client errors). If any event lasts for longer than 10 second in the queue, it will be discarded.</p><h2 id="known-issues" class="section-heading">
  <a href="#known-issues" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">known-issues</p>
  </a>
  Known issues
</h2>
<p>At the moment, trigger delivery policies in general do not provide a guarantee of in-order delivery of events.
Refer to the <a href="062-trigger_delivery_policies.html#known-issues">Architecture Documentation</a> for more information on this.</p>
<div class="bottom-actions">
  <div class="bottom-actions-item">

      <a href="060-using_triggers.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Using Triggers
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="065-managing-groups.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Managing Groups
        </span>
      </a>

  </div>
</div>
      <footer class="footer">

        <p>
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.29.0) for the

            <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
