<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.29.0">
    <meta name="project" content="Clea Astarte v1.2.0">

    <title>Querying a Device — Clea Astarte v1.2.0</title>
    <link rel="stylesheet" href="dist/html-elixir-2YOS5DIE.css" />

    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-X7YVL3G2.js"></script>
    <script src="dist/sidebar_items-C9FC9F15.js"></script>

      <script src="../common_vars.js"></script>

    <script async src="dist/html-XN2TSG4M.js"></script>


  </head>
  <body data-type="extras" class="page-extra">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle" aria-label="toggle sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <i class="ri-search-2-line" aria-hidden="true" title="Submit search"></i>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <i class="ri-close-line ri-lg" aria-hidden="true" title="Cancel search"></i>
    </button>
    <label class="search-label">
      <p class="sr-only">Search</p>
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">

      <a href="https://docs.astarte-platform.org/astarte/1.0/">
        <img src="assets/logo.png" alt="Clea Astarte" class="sidebar-projectImage">
      </a>

    <div class="sidebar-projectDetails">
      <a href="https://docs.astarte-platform.org/astarte/1.0/" class="sidebar-projectName" translate="no">
Clea Astarte
      </a>
      <strong class="sidebar-projectVersion" translate="no">
        v1.2.0
      </strong>
    </div>
    <ul class="sidebar-listNav">
      <li><a id="extras-list-link" href="#full-list">Pages</a></li>


    </ul>
  </div>

  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>
<button class="settings display-settings">
  <i class="ri-settings-3-line"></i>
  <span class="sr-only">Settings</span>
</button>


    <a href="https://github.com/astarte-platform/astarte/blob/release-1.0/doc/pages/user/050-query_device.md#L1" title="View Source" class="view-source" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>

  <span>Querying a Device</span>
</h1>

<p>Once you have your devices connected, up and running in Astarte, you can start interacting with them.</p><h2 id="device-status" class="section-heading">
  <a href="#device-status" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">device-status</p>
  </a>
  Device status
</h2>
<p>First things first, you can check if your device is correctly registered in Astarte, and its current status.
Let's assume our Device has <code class="inline">f0VMRgIBAQAAAAAAAAAAAA</code> as its id.
A Device's status includes a number of useful information, among which whether it is connected or not to its Transport,
its introspection, the amount of exchanged data and more.</p><h3 id="query-device-status-using-astartectl" class="section-heading">
  <a href="#query-device-status-using-astartectl" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">query-device-status-using-astartectl</p>
  </a>
  Query Device status using astartectl
</h3>
<pre><code class="makeup bash" translate="no"><span class="gp unselectable">$ </span><span class="">astartectl appengine devices show f0VMRgIBAQAAAAAAAAAAAA
</span><span class="">Device ID:                      f0VMRgIBAQAAAAAAAAAAAA
</span><span class="">Connected:                      false
</span><span class="">Last Connection:                2018-02-07 18:38:57.266 +0000 UTC
</span><span class="">Last Disconnection:             2018-02-08 09:49:26.566 +0000 UTC
</span><span class="">Introspection:                  com.example.ExampleInterface v1.0 exchanged messages: 20 exchanged bytes: 200B
</span><span class="">                                org.example.TestInterface v0.2 exchanged messages: 8 exchanged bytes: 147B
</span><span class="">Received Messages:              221
</span><span class="">Data Received:                  11.7K
</span><span class="">Last Seen IP:                   203.0.113.89
</span><span class="">Last Credentials Request IP:    203.0.113.201
</span><span class="">First Registration:             2018-01-31 17:10:59.270 +0000 UTC
</span><span class="">First Credentials Request:      2018-01-31 17:10:59.270 +0000 UTC
</span></code></pre><h3 id="query-device-status-using-astarte-dashboard" class="section-heading">
  <a href="#query-device-status-using-astarte-dashboard" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">query-device-status-using-astarte-dashboard</p>
  </a>
  Query Device status using Astarte Dashboard
</h3>
<p>After logging in to Astarte dashboard, go to the &quot;Devices&quot; page clicking on the menu on your left. A list of
available Device IDs will appear. If you do not see your device at a glance, use the search bar on the top right
to find it.
Clicking on the Device ID will take you to its details page.</p><h3 id="query-device-status-using-appengine-api" class="section-heading">
  <a href="#query-device-status-using-appengine-api" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">query-device-status-using-appengine-api</p>
  </a>
  Query Device status using AppEngine API
</h3>
<p><code class="inline">GET api.&lt;your astarte domain&gt;/appengine/v1/test/devices/f0VMRgIBAQAAAAAAAAAAAA</code></p><pre><code class="makeup json" translate="no"><span class="p" data-group-id="9767259673-1">{</span><span class="w">
    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9767259673-2">{</span><span class="w">
        </span><span class="nt">&quot;total_received_msgs&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">221</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;total_received_bytes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">11660</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;last_seen_ip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;203.0.113.89&quot;</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;last_credentials_request_ip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;203.0.113.201&quot;</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;last_disconnection&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2018-02-07T18:38:57.266Z&quot;</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;last_connection&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2018-02-08T09:49:26.556Z&quot;</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;f0VMRgIBAQAAAAAAAAAAAA&quot;</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;first_registration&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2018-01-31T17:10:59.270Z&quot;</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;connected&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;introspection&quot;</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9767259673-3">{</span><span class="w">
            </span><span class="s2">&quot;com.example.ExampleInterface&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9767259673-4">{</span><span class="w">
                </span><span class="s2">&quot;major&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="s2">&quot;minor&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nt">&quot;exchanged_msgs&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
                </span><span class="nt">&quot;exchanged_bytes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
            </span><span class="p" data-group-id="9767259673-4">}</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;org.example.TestInterface&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9767259673-5">{</span><span class="w">
                </span><span class="s2">&quot;major&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="s2">&quot;minor&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
                </span><span class="nt">&quot;exchanged_msgs&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w">
                </span><span class="nt">&quot;exchanged_bytes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">147</span><span class="w">
            </span><span class="p" data-group-id="9767259673-5">}</span><span class="w">
        </span><span class="p" data-group-id="9767259673-3">}</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;aliases&quot;</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9767259673-6">{</span><span class="w">
            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;device_a&quot;</span><span class="w">
        </span><span class="p" data-group-id="9767259673-6">}</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;attributes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9767259673-7">{</span><span class="w">
            </span><span class="nt">&quot;attributes_key&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;attributes_value&quot;</span><span class="w">
        </span><span class="p" data-group-id="9767259673-7">}</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9767259673-8">[</span><span class="w">
            </span><span class="s2">&quot;my_group&quot;</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="9767259673-8">]</span><span class="p">,</span><span class="w">
        </span><span class="nt">&quot;previous_interfaces&quot;</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9767259673-9">[</span><span class="w">
            </span><span class="p" data-group-id="9767259673-10">{</span><span class="w">
                </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.example.ExampleInterface&quot;</span><span class="p">,</span><span class="w">
                </span><span class="s2">&quot;major&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="s2">&quot;minor&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
                </span><span class="nt">&quot;exchanged_msgs&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
                </span><span class="nt">&quot;exchanged_bytes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">120</span><span class="w">
            </span><span class="p" data-group-id="9767259673-10">}</span><span class="w">
        </span><span class="p" data-group-id="9767259673-9">]</span><span class="w">
    </span><span class="p" data-group-id="9767259673-2">}</span><span class="w">
</span><span class="p" data-group-id="9767259673-1">}</span></code></pre><p>Through the API, it is also possible to get the Introspection of the device only:</p><p><code class="inline">GET api.&lt;your astarte domain&gt;/appengine/v1/test/devices/f0VMRgIBAQAAAAAAAAAAAA/interfaces</code></p><pre><code class="makeup json" translate="no"><span class="p" data-group-id="6178775737-1">{</span><span class="w">
    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="6178775737-2">[</span><span class="w">
        </span><span class="s2">&quot;com.example.ExampleInterface&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;com.example.TestInterface&quot;</span><span class="w">
    </span><span class="p" data-group-id="6178775737-2">]</span><span class="w">
</span><span class="p" data-group-id="6178775737-1">}</span></code></pre><p>This returns the Interfaces which the device reported in its Introspection <em>and</em> which are known to the Realm.</p><p>Arbitrary information can be added to the device by means of <code class="inline">attributes</code>: they allow to store any
number of string values associated to a corresponding string key.
To set, modify and delete <code class="inline">attributes</code>, a <code class="inline">PATCH</code> on the device endpoint is required:</p><pre><code class="makeup elixir" translate="no"><span class="nc">PATCH</span><span class="w"> </span><span class="n">api</span><span class="o">.</span><span class="o">&lt;</span><span class="n">your</span><span class="w"> </span><span class="n">astarte</span><span class="w"> </span><span class="n">domain</span><span class="o">&gt;</span><span class="o">/</span><span class="n">appengine</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">devices</span><span class="o">/</span><span class="n">f0VMRgIBAQAAAAAAAAAAAA</span></code></pre><p>In the request body, the <code class="inline">data</code> JSON object should have a <code class="inline">attributes</code> key which bears a dictionary
of strings. A valid request body which changes only device attributes, for example, is
<code class="inline">{&quot;data&quot;:{&quot;attributes&quot;: {&quot;&lt;key&gt;&quot;: &quot;&lt;value&gt;&quot;}}}</code>. To delete an attribute entry, set the value of the
corresponding key to <code class="inline">null</code>. For example, POSTing <code class="inline">{&quot;data&quot;:{&quot;attributes&quot;: {&quot;my_key&quot;: null}}}</code> will
remove the <code class="inline">my_key</code> attribute entry from the device.</p><p>Depending on the aggregation and ownership of the Interface, you can <code class="inline">GET</code>/<code class="inline">PUT</code>/<code class="inline">POST</code> on the interface itself or one of its mappings,
or use <code class="inline">astartectl</code> to perform the same operation on the command line. Some examples are:</p><h3 id="get-data-from-an-aggregate-device-properties-interface" class="section-heading">
  <a href="#get-data-from-an-aggregate-device-properties-interface" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">get-data-from-an-aggregate-device-properties-interface</p>
  </a>
  Get data from an <code class="inline">aggregate</code> <code class="inline">device</code> <code class="inline">properties</code> interface
</h3>
<p><code class="inline">astartectl</code> invocation: <code class="inline">astartectl appengine devices data-snapshot f0VMRgIBAQAAAAAAAAAAAA com.example.ExampleInterface</code></p><p>AppEngine API invocation: <code class="inline">GET api.&lt;your astarte domain&gt;/appengine/v1/test/devices/f0VMRgIBAQAAAAAAAAAAAA/interfaces/com.example.ExampleInterface</code></p><h3 id="get-last-sent-value-from-an-individual-device-datastream-interface" class="section-heading">
  <a href="#get-last-sent-value-from-an-individual-device-datastream-interface" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">get-last-sent-value-from-an-individual-device-datastream-interface</p>
  </a>
  Get last sent value from an <code class="inline">individual</code> <code class="inline">device</code> <code class="inline">datastream</code> interface
</h3>
<p><code class="inline">astartectl</code> invocation: <code class="inline">astartectl appengine devices data-snapshot f0VMRgIBAQAAAAAAAAAAAA com.example.TestInterface</code></p><p>AppEngine API invocation: <code class="inline">GET api.&lt;your astarte domain&gt;/appengine/v1/test/devices/f0VMRgIBAQAAAAAAAAAAAA/interfaces/com.example.TestInterface/myValue?limit=1</code></p><h3 id="set-values-in-an-individual-server-datastream-interface" class="section-heading">
  <a href="#set-values-in-an-individual-server-datastream-interface" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">set-values-in-an-individual-server-datastream-interface</p>
  </a>
  Set values in an <code class="inline">individual</code> <code class="inline">server</code> <code class="inline">datastream</code> interface
</h3>
<p><code class="inline">astartectl</code> invocation: <code class="inline">astartectl appengine devices send-data f0VMRgIBAQAAAAAAAAAAAA com.example.OtherTestInterface /myOtherValue &lt;value&gt;</code></p><p>AppEngine API invocation: <code class="inline">POST api.&lt;your astarte domain&gt;/appengine/v1/test/devices/f0VMRgIBAQAAAAAAAAAAAA/interfaces/com.example.OtherTestInterface/myOtherValue</code>
Request body: <code class="inline">{&quot;data&quot;: &lt;value&gt;}</code></p><h3 id="api-query-semantics" class="section-heading">
  <a href="#api-query-semantics" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">api-query-semantics</p>
  </a>
  API Query semantics
</h3>
<p>In general, to query AppEngine, the following things must be kept in mind</p><ul><li>When sending data, use <code class="inline">PUT</code> if dealing with <code class="inline">properties</code>, <code class="inline">POST</code> if dealing with <code class="inline">datastream</code>.</li><li>When <code class="inline">GET</code>ting, if you are querying an <code class="inline">aggregate</code> interface, make sure to query the interface itself rather than its mappings.</li><li>When <code class="inline">GET</code>ting <code class="inline">datastream</code>, keep in mind that AppEngine's default behavior is to return a large as possible timeseries.</li></ul><h2 id="navigating-and-retrieving-datastream-results-through-apis" class="section-heading">
  <a href="#navigating-and-retrieving-datastream-results-through-apis" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">navigating-and-retrieving-datastream-results-through-apis</p>
  </a>
  Navigating and retrieving Datastream results through APIs
</h2>
<p>The Datastream case is significant, as it might be common to have <em>a lot</em> of values for each endpoint/interface. As such, returning all of them in a single API call is most of the times not desirable nor recommended.</p><p>To avoid putting the cluster under excessive pressure, AppEngine API is configured with a hard cap on the maximum number of returned results for each single call, with a sane default of <code class="inline">10000</code>. Although this hard cap is entirely configurable, please be aware that AppEngine API is designed to process a lot of reasonably small requests in the shortest possible time, and hence is <strong>not optimised nor strongly tested against big requests</strong>. Make sure that AppEngine API has enough resources available to cope with the maximum dataset size.</p><p>AppEngine API provides you with a variety of mechanisms to make retrieval and navigation of large data sets as smooth and efficient as possible.</p><h3 id="limit" class="section-heading">
  <a href="#limit" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">limit</p>
  </a>
  Limit
</h3>
<p>Adding a <code class="inline">limit=n</code> to the URL query tells AppEngine to return no more than <code class="inline">n</code> results. This acts similarly to a <code class="inline">LIMIT</code> SQL statement, but, as it stands, it does not impose a hard limit on the whole retrieved dataset but on the amount of the results displayed by the API call - see <a href="#pagination-and-time-windows">Pagination and Time Windows</a> for more details on this topic and the performance implications of different limits in queries.</p><p>If the specified <code class="inline">limit</code> is beyond the hard cap, the query won't fail, but will return at most the amount set by the hard cap, without further warnings.</p><h3 id="since-to-since-after" class="section-heading">
  <a href="#since-to-since-after" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">since-to-since-after</p>
  </a>
  Since/To/Since After
</h3>
<p>Results can be limited to a specific time window. <code class="inline">since</code> and <code class="inline">to</code> can be set to a ISO 8601 valid timestamp to limit on an upper and lower bound the result set. This can also be combined with <code class="inline">limit</code> to make sure that no more than <code class="inline">n</code> results are returned. Also, <code class="inline">since</code> and <code class="inline">to</code> can as well be set independently to provide only an upper or lower bound.</p><p>In case you're dealing with a very large dataset and you want to dump it, it is likely that you need to go beyond what a reasonable default limit looks like. In those cases, you can use the <code class="inline">since_after</code> query parameter to retrieve parameters within a time window. <code class="inline">since_after</code> slices the time window just like <code class="inline">since</code> does, but it does not include values matching the specified timestamp, if any. This is especially useful when paginating, to start right after a returned result.</p><h3 id="pagination-and-time-windows" class="section-heading">
  <a href="#pagination-and-time-windows" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">pagination-and-time-windows</p>
  </a>
  Pagination and time windows
</h3>
<p>AppEngine API provides you automatically with a time window-based pagination. When <code class="inline">GET</code>ting a <code class="inline">datastream</code>, if more results are available beyond the chosen time window/limit, a <code class="inline">links</code> map will be provided, in JSON-API style, to allow the user to paginate the results accordingly using <code class="inline">since_after</code>.</p><p>You can use <code class="inline">limit</code> to determine each page's size. When specifying a valid <code class="inline">limit</code>, the <code class="inline">links</code> will keep the page size consistent over the next calls.</p><p>However, <code class="inline">limit</code> should be used wisely to lower the pressure on the cluster. Each API call maps to a query that, no matter how efficient, has a computational cost. A few mid-sized queries should <strong>always</strong> be preferred over a large amount of smaller queries. Given your cluster is configured correctly, <code class="inline">limit</code> should be omitted in most cases when paginating, and you should rather trust your cluster's hard cap to be the sweet spot in efficiency and cluster pressure.</p><h3 id="downsampling" class="section-heading">
  <a href="#downsampling" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">downsampling</p>
  </a>
  Downsampling
</h3>
<p>Especially when plotting graphs, retrieving all points in a time series isn't desirable. Astarte provides you with an implementation of the <a href="https://skemman.is/bitstream/1946/15343/3/SS_MSthesis.pdf">LTTB Downsampling Algorithm</a>, which is used to return only a fixed number of samples from a time series. When setting <code class="inline">downsample_to=n</code>, AppEngine will return a maximum of <code class="inline">n</code> results, which are the most significant over the considered time series according to the algorithm.</p><p>Due to how LTTB works, <code class="inline">downsample_to</code> <strong>must</strong> be <code class="inline">&gt;2</code>, as the algorithm will return the two ends of the considered value bucket, and <code class="inline">n-2</code> values which are the picked samples. Please refer to the <a href="https://github.com/ispirata/ex_lttb">LTTB implementation used by Astarte</a> to learn more about how this algorithm affects samples and its limitations.</p><p><code class="inline">downsample_to=x</code> can be used in conjunction with other query parameters, including <code class="inline">limit=y</code>. When doing so, Astarte will downsample to <code class="inline">x</code> samples the dataset composed of the last <code class="inline">y</code> values. Every feature previously outlined is in fact available with downsampling, including pagination - bear in mind, though, that for how the algorithm works, some options have drastically different semantic effects.</p><p>Also, the hard cap has a very different meaning in downsampling. In this case, the hard cap applies to <code class="inline">downsample_to</code> instead of <code class="inline">limit</code>. <code class="inline">limit</code> can be an arbitrarly large amount of samples taken out of the DB, and can be used mainly to alleviate pressure in case of <em>extremely</em> large datasets which would require a lot of time for being processed by LTTB - even though, most of the time, you might want to define a time window to downsample instead.</p><p>Astarte is also capable of downsampling aggregated interfaces, as long as a <code class="inline">downsample_key</code> is specified, which has to match the last token of an <code class="inline">endpoint</code> of the queried <code class="inline">interface</code> (i.e. in case the interface has a <code class="inline">/%{id}/myValue</code> mapping which should be used as the <code class="inline">downsample_key</code>, you should specify <code class="inline">downsample_key=myValue</code> in the query). When doing so, the aggregate will be downsampled using the chosen <code class="inline">endpoint</code> value as the <code class="inline">y</code> axis value, whereas its other <code class="inline">endpoints</code> will be disregarded when applying the algorithm. Please note that, no matter what <code class="inline">downsample_key</code> is used, a sample will be composed by the whole aggregation.</p><p>If there is no way an interface can be downsampled (this is true, for example, if no <code class="inline">downsample_key</code> has been specified for <code class="inline">aggregations</code>, or for types such as <code class="inline">strings</code>), AppEngine API will return a <code class="inline">4xx</code> error. In general, downsampling is a powerful mechanism with a lot of limitations which really shines when plotting. Once again, this is a fundamental factor to consider when <a href="029-interface_design_guide.html">designing your interfaces</a>.</p><h2 id="real-time-updates" class="section-heading">
  <a href="#real-time-updates" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">real-time-updates</p>
  </a>
  Real-Time Updates
</h2>
<p>The http REST API returns a static result, therefore API clients should either poll the REST API when displaying real-time changes or use a WebSocket.
WebSockets are called <a href="052-using_channels.html">Astarte Channels</a> in Astarte jargon, and they should be considered as a more efficient alternative to polling.
When <a href="052-using_channels.html">using Astarte Channels</a> the REST API should be used to retrieve the initial status.</p><h2 id="astartectl-specific-features" class="section-heading">
  <a href="#astartectl-specific-features" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">astartectl-specific-features</p>
  </a>
  astartectl-specific features
</h2>
<p><code class="inline">astartectl</code> implements some convenience methods that make navigation easier. In particular, <code class="inline">astartectl</code> allows for any of the AppEngine API query parameters/mechanisms, but also implements automated pagination, snapshots and more.</p><h3 id="data-snapshot" class="section-heading">
  <a href="#data-snapshot" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">data-snapshot</p>
  </a>
  Data Snapshot
</h3>
<p><code class="inline">astartectl</code> has a unique feature that allows to retrieve a &quot;Data Snapshot&quot; of a device, namely the last known value for every interface available in the Device's introspection. This is extremely useful to have an at-a-glance view of the Device status with regards to data. Simply invoke <code class="inline">astartectl appengine devices data-snapshot &lt;device ID&gt;</code>, or <code class="inline">astartectl appengine devices data-snapshot &lt;device ID&gt; &lt;interface name&gt;</code> to get a snapshot for a single interface.</p><h3 id="advanced-querying" class="section-heading">
  <a href="#advanced-querying" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">advanced-querying</p>
  </a>
  Advanced querying
</h3>
<p><code class="inline">astartectl appengine devices get-samples</code> is <code class="inline">astartectl</code>'s frontend to advanced query. Refer to the command line documentation to learn about all available parameters, which match all of the parameters found in AppEngine API. The main difference is that, in case a query would break the boundaries of the page limit, <code class="inline">astartectl</code> will automatically paginate the request, and return all of the samples.</p><h3 id="exporting-devices-data-with-astartectl" class="section-heading">
  <a href="#exporting-devices-data-with-astartectl" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">exporting-devices-data-with-astartectl</p>
  </a>
  Exporting Devices Data with astartectl
</h3>
<p>The previous feature makes <code class="inline">astartectl</code> extremely useful when it comes to export or dump data. Moreover, <code class="inline">get-samples</code> features a <code class="inline">--output</code> option, which allows to print the results in different formats, such as <code class="inline">json</code> or <code class="inline">CSV</code>. This way, exporting values becomes extremely easy, as <code class="inline">get-samples</code> can easily tap into an Interface's entire data set and print it into a CSV file.</p><h2 id="deleting-a-device" class="section-heading">
  <a href="#deleting-a-device" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">deleting-a-device</p>
  </a>
  Deleting a Device
</h2>
<p>If you want to entirely remove a device from your realm along with its data, it is possible to do so with the
device deletion API.
Note that the Astarte API also allows for the unregistration and the inhibition of a specific device, which
should be enough in most use cases and do not cause any data loss.</p><blockquote><p>[!IMPORTANT]
Once the deletion of a device is started, all data related to the device will be lost.</p></blockquote><h3 id="device-deletion-using-realm-management-api" class="section-heading">
  <a href="#device-deletion-using-realm-management-api" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">device-deletion-using-realm-management-api</p>
  </a>
  Device deletion using Realm Management API
</h3>
<p>Let's assume our Device has <code class="inline">f0VMRgIBAQAAAAAAAAAAAA</code> as its id.
To delete it, use the following API. The deletion operation is asynchronous and can take up to 15 minutes.
During the process, you device status will appear as &quot;In deletion&quot;.</p><p><code class="inline">DELETE api.&lt;your astarte domain&gt;/realmmanagement/v1/test/devices/f0VMRgIBAQAAAAAAAAAAAA</code></p>
<div class="bottom-actions">
  <div class="bottom-actions-item">

      <a href="045-device_errors.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Device errors
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="052-using_channels.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Using Astarte Channels (WebSockets)
        </span>
      </a>

  </div>
</div>
      <footer class="footer">

        <p>
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.29.0) for the

            <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
